
# System design

## 1.Scalability

通过增加硬件、软件资源，使得系统可以支持更大的访问量。

- Vertical scaling(增加机器数量)
- Horizontal scaling(增加机器性能)
- 缓存
  - client端，浏览器， ip, server
  - server端，query和结果对应关系
- 负载均衡
  - Ip balance
  - Application balance
- 数据库复制
  - 容灾
  - 提高访问效率（一致性问题）
- 数据库分区

## 2.trade-off

- 性能与可扩展性
  - 性能：单个用户访问
  - 可扩展性： 高负载下变慢
- 延迟和吞吐量
  - 延迟：得到结果所需要的时间
  - 吞吐量（QPS）单位时间内接受Query的个数
  - 在可接受的延迟下，最大化接受吞吐量
- 可用性与一致性
  - CAP理论
  - CP 一致性和分区容错，等待分区节点相应可能导致延迟错误。对于原子读很适合（金融，钱）
  - AP 数据可能不是最新的，需要一定时间传播写入结果。业务要求允许最终一致性。
  - 一致性模式：弱一致性（AP），强一致性(CP)，最终一致性(AP email, DNS)
  - 可用性模式：
    - 工作到备用切换
    - 双工作切换
    - 故障切换可能丢失数据
    - 复制数据库（主从，主主复制）

